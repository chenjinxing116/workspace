rem	-------------------------------------------------------------------------
rem	Write by yulingfei 2016-10-17
rem	-------------------------------------------------------------------------
rem 项目发布批处理接口约定；deploy_root通过参数决定，其他参数根据deploy_root及项目特征自行计算决定。
rem	deploy_root:	项目总根目录
rem	deploy_war:		项目war文件


rem 计算源码目录
rem	-------------------------------------------------------------------------
set myself=%~dp0
set project_dir=%myself%
rem	-------------------------------------------------------------------------

rem	-------------------------------------------------------------------------
set deploy_root=%1
IF "%deploy_root%"=="" (
	set deploy_root=%myself%package
) 
set deploy_war=%deploy_root%


rem	-------------------------------------------------------------------------

rem 生成目标目录
rem	-------------------------------------------------------------------------
mkdir "%deploy_war%"

rem	-------------------------------------------------------------------------
rem 清理
rem	-------------------------------------------------------------------------
pushd %project_dir%
	rd /s /q "target"
	rd /s /q "package"
popd
rem	-------------------------------------------------------------------------

rem 编译
rem	-------------------------------------------------------------------------
pushd %project_dir%
	cmd.exe /c mvn -f pom.xml package
popd
rem	-------------------------------------------------------------------------

rem 拷贝
rem	-------------------------------------------------------------------------
pushd %project_dir%
	xcopy	"target\*.war" "%deploy_war%" /Y  /I	
popd
rem copy svn revision

rem 清理
rem	-------------------------------------------------------------------------
pushd %project_dir%
	rd /s /q "target"
popd
rem	-------------------------------------------------------------------------
